<?xml version="1.0" encoding="utf-8"?>
<project basedir="." name="tpod" default="main">

  <property name="input.dir" value="input"/>
  <property name="lib.dir" value="output"/>
  <property name="output.dir" value="output"/>
  <property name="temp.dir" value="temp"/>

  <!-- initialiseer jar-files -->

  <target name="jar" description="Initialiseer jar-files">
    <path id="build.classpath">
      <fileset dir="${lib.dir}">
        <include name="**/*.jar"/>
        <include name="**/*.zip"/>
      </fileset>
    </path>
  </target>

  <!-- initialiseer mappen -->

  <target name="init" description="Initialiseer mappen">
    <delete dir="${output.dir}" failonerror="no" includeemptydirs="true"/>
    <mkdir dir="${output.dir}"/>
    <delete dir="${temp.dir}" failonerror="no" includeemptydirs="true"/>
    <mkdir dir="${temp.dir}"/>
  </target>

  <!-- unzip word-bestand -->

  <target name="unzip" description="Unzip word-bestand">
    <unzip dest="${temp.dir}/template">
      <path id="input.id">
        <fileset dir="${input.dir}" includes="*.docx"/>
      </path>
    </unzip>
  </target>

  <!-- transformeer xml-bestanden -->

  <target name="transform" description="Splits word-bestand">
    <pathconvert property="input.fullname" refid="input.id"/>
    <basename property="input.name" file="${input.fullname}"/>
    <xslt in="${temp.dir}/template/word/document.xml" out="${temp.dir}/fragmenten/manifest.xml" style="tpod_splitsen.xsl">
      <factory name="net.sf.saxon.TransformerFactoryImpl.class"/>
      <classpath refid="build.classpath"/>
    </xslt>
  </target>

  <!-- totale transformatie -->

  <target name="main" description="Totale transformatie" depends="jar,init,unzip,transform"/>

</project>